<!DOCTYPE html>
<html lang="mk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—ò–∞ –î–æ–±—Ä–æ—Å–æ—Å—Ç–æ—ò–±–∞ - –°–∞–º–æ–µ–≤–∞–ª—É–∞—Ü–∏—ò–∞</title>
<!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>-->
    <!-- Load jsPDF and Cyrillic-supported Roboto font -->
    <script src="https://unpkg.com/docx@8.3.0/build/index.umd.js"></script>

    <script src="https://unpkg.com/jspdf@2.5.1/dist/polyfills.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf@2.5.1/dist/fonts/Roboto-Regular.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #4a5568;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .category-icon {
            font-size: 1.8em;
        }

        .question {
            margin-bottom: 25px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .question h3 {
            color: #2d3748;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: #667eea;
            background: #edf2f7;
            transform: translateX(5px);
        }

        .option input[type="radio"] {
            margin-right: 12px;
            accent-color: #667eea;
        }

        .option.selected {
            border-color: #667eea;
            background: #edf2f7;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
            transform: translateY(-2px);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .results {
            text-align: center;
        }

        .category-result {
            margin-bottom: 30px;
            padding: 25px;
            background: #f7fafc;
            border-radius: 15px;
            border-left: 5px solid #48bb78;
        }

        .category-result.warning {
            border-left-color: #ed8936;
        }

        .category-result.concern {
            border-left-color: #e53e3e;
        }

        .score {
            font-size: 2.5em;
            font-weight: bold;
            color: #48bb78;
            margin-bottom: 10px;
        }

        .score.warning {
            color: #ed8936;
        }

        .score.concern {
            color: #e53e3e;
        }

        .feedback {
            color: #2d3748;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .tips {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: left;
        }

        .tips h4 {
            color: #2d3748;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tips ul {
            color: #4a5568;
            padding-left: 20px;
        }

        .tips li {
            margin-bottom: 8px;
        }

        .intro {
            text-align: center;
            color: #4a5568;
            line-height: 1.8;
        }

        .intro p {
            margin-bottom: 20px;
        }

        .highlight {
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            h1 {
                font-size: 1.8em;
            }

            .navigation {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
<div class="container">
    <!-- Progress Bar -->
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- Introduction Step -->
    <div class="step active" id="step-intro">
        <h1>üåü –ú–æ—ò–∞ –î–æ–±—Ä–æ—Å–æ—Å—Ç–æ—ò–±–∞</h1>
        <div class="intro">
            <p>–î–æ–±—Ä–µ–¥–æ—ò–¥–µ –≤–æ —Ç–≤–æ—ò–∞—Ç–∞ –ª–∏—á–Ω–∞ —Å–∞–º–æ–µ–≤–∞–ª—É–∞—Ü–∏—ò–∞! üéØ</p>
            <p>–û–≤–∞ –µ <span class="highlight">–±–µ–∑–±–µ–¥–Ω–æ –º–µ—Å—Ç–æ</span> –∫–∞–¥–µ –º–æ–∂–µ—à –¥–∞ –ø—Ä–æ–≤–µ—Ä–∏—à –∫–∞–∫–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –∏ —à—Ç–æ –º–æ–∂–µ—à –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—à –∑–∞ –¥–∞ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à —É—à—Ç–µ –ø–æ–¥–æ–±—Ä–æ.</p>
            <p>–ü—Ä–∞—à–∞—ö–∞—Ç–∞ —Å–µ <span class="highlight">–∞–Ω–æ–Ω–∏–º–Ω–∏</span> - –Ω–µ –º–æ—Ä–∞—à –¥–∞ —Å–µ –ø—Ä–µ—Ç—Å—Ç–∞–≤—É–≤–∞—à. –°–∞–º–æ –±–∏–¥–∏ –∏—Å–∫—Ä–µ–Ω/–∞ —Å–æ —Å–µ–±–µ! üí≠</p>
            <p>–ù–∞ –∫—Ä–∞—ò–æ—Ç —ú–µ –¥–æ–±–∏–µ—à –ª–∏—á–Ω–∏ —Å–æ–≤–µ—Ç–∏ –∏ –º–æ–∂–Ω–æ—Å—Ç –¥–∞ –≥–∏ –∑–∞—á—É–≤–∞—à —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ.</p>
        </div>
        <div class="navigation">
            <div></div>
            <button class="btn btn-primary" onclick="nextStep()">–ü–æ—á–Ω–∏ üöÄ</button>
        </div>
    </div>

    <!-- Physical Health Step -->
    <div class="step" id="step-physical">
        <h2><span class="category-icon">üèÉ‚Äç‚ôÇÔ∏è</span> –§–∏–∑–∏—á–∫–æ –ó–¥—Ä–∞–≤—ò–µ</h2>

        <div class="question">
            <h3>–ö–æ–ª–∫—É —á–∞—Å–∞ —Å–ø–∏–µ—à –≤–æ —Ç–µ–∫–æ—Ç –Ω–∞ –Ω–æ—ú—Ç–∞?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="sleep" value="3"> –ü–æ–º–∞–ª–∫—É –æ–¥ 6 —á–∞—Å–∞
                </label>
                <label class="option">
                    <input type="radio" name="sleep" value="2"> 6-7 —á–∞—Å–∞
                </label>
                <label class="option">
                    <input type="radio" name="sleep" value="1"> 8-9 —á–∞—Å–∞
                </label>
                <label class="option">
                    <input type="radio" name="sleep" value="0"> –ü–æ–≤–µ—ú–µ –æ–¥ 9 —á–∞—Å–∞
                </label>
            </div>
        </div>

        <div class="question">
            <h3>–ö–æ–ª–∫—É —á–µ—Å—Ç–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à —É–º–æ—Ä–µ–Ω/–∞ –≤–æ —Ç–µ–∫–æ—Ç –Ω–∞ –¥–µ–Ω–æ—Ç?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="fatigue" value="3"> –°–µ–∫–æ—ò–¥–Ω–µ–≤–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="fatigue" value="2"> –ù–µ–∫–æ–ª–∫—É –ø–∞—Ç–∏ –Ω–µ–¥–µ–ª–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="fatigue" value="1"> –ü–æ–Ω–µ–∫–æ–≥–∞—à
                </label>
                <label class="option">
                    <input type="radio" name="fatigue" value="0"> –†–µ—Ç–∫–æ –∏–ª–∏ –Ω–∏–∫–æ–≥–∞—à
                </label>
            </div>
        </div>

        <div class="question">
            <h3>–ö–æ–ª–∫—É —á–µ—Å—Ç–æ —Å–µ —Ñ–∏–∑–∏—á–∫–∏ –∞–∫—Ç–∏–≤–µ–Ω/–∞ (—Å–ø–æ—Ä—Ç, —Ç—Ä—á–∞—ö–µ, –≤–µ–ª–æ—Å–∏–ø–µ–¥)?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="activity" value="0"> –°–µ–∫–æ—ò–¥–Ω–µ–≤–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="activity" value="1"> 3-4 –ø–∞—Ç–∏ –Ω–µ–¥–µ–ª–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="activity" value="2"> 1-2 –ø–∞—Ç–∏ –Ω–µ–¥–µ–ª–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="activity" value="3"> –†–µ—Ç–∫–æ –∏–ª–∏ –Ω–∏–∫–æ–≥–∞—à
                </label>
            </div>
        </div>

        <div class="navigation">
            <button class="btn btn-secondary" onclick="prevStep()">‚Üê –ù–∞–∑–∞–¥</button>
            <button class="btn btn-primary" onclick="nextStep()">–ü–æ–Ω–∞—Ç–∞–º—É ‚Üí</button>
        </div>
    </div>

    <!-- Mental Health Step -->
    <div class="step" id="step-mental">
        <h2><span class="category-icon">üß†</span> –ú–µ–Ω—Ç–∞–ª–Ω–æ –ó–¥—Ä–∞–≤—ò–µ</h2>

        <div class="question">
            <h3>–ö–æ–ª–∫—É —á–µ—Å—Ç–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –ø–æ–¥ —Å—Ç—Ä–µ—Å?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="stress" value="3"> –°–µ–∫–æ—ò–¥–Ω–µ–≤–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="stress" value="2"> –ù–µ–∫–æ–ª–∫—É –ø–∞—Ç–∏ –Ω–µ–¥–µ–ª–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="stress" value="1"> –ü–æ–Ω–µ–∫–æ–≥–∞—à
                </label>
                <label class="option">
                    <input type="radio" name="stress" value="0"> –†–µ—Ç–∫–æ –∏–ª–∏ –Ω–∏–∫–æ–≥–∞—à
                </label>
            </div>
        </div>

        <div class="question">
            <h3>–ö–æ–ª–∫—É —á–µ—Å—Ç–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à —Ç–∞–∂–µ–Ω/–∞ –∏–ª–∏ –¥–µ–ø—Ä–µ—Å–∏–≤–µ–Ω/–∞?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="sadness" value="3"> –°–µ–∫–æ—ò–¥–Ω–µ–≤–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="sadness" value="2"> –ù–µ–∫–æ–ª–∫—É –ø–∞—Ç–∏ –Ω–µ–¥–µ–ª–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="sadness" value="1"> –ü–æ–Ω–µ–∫–æ–≥–∞—à
                </label>
                <label class="option">
                    <input type="radio" name="sadness" value="0"> –†–µ—Ç–∫–æ –∏–ª–∏ –Ω–∏–∫–æ–≥–∞—à
                </label>
            </div>
        </div>

        <div class="question">
            <h3>–ö–æ–ª–∫—É –ª–µ—Å–Ω–æ —Å–µ —Å–ø—Ä–∞–≤—É–≤–∞—à —Å–æ –ø—Ä–æ–±–ª–µ–º–∏—Ç–µ?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="coping" value="0"> –ú–Ω–æ–≥—É –ª–µ—Å–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="coping" value="1"> –õ–µ—Å–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="coping" value="2"> –¢–µ—à–∫–æ
                </label>
                <label class="option">
                    <input type="radio" name="coping" value="3"> –ú–Ω–æ–≥—É —Ç–µ—à–∫–æ
                </label>
            </div>
        </div>

        <div class="navigation">
            <button class="btn btn-secondary" onclick="prevStep()">‚Üê –ù–∞–∑–∞–¥</button>
            <button class="btn btn-primary" onclick="nextStep()">–ü–æ–Ω–∞—Ç–∞–º—É ‚Üí</button>
        </div>
    </div>

    <!-- Social Connections Step -->
    <div class="step" id="step-social">
        <h2><span class="category-icon">üë•</span> –°–æ—Ü–∏—ò–∞–ª–Ω–∏ –í—Ä—Å–∫–∏</h2>

        <div class="question">
            <h3>–ö–æ–ª–∫—É —á–µ—Å—Ç–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –æ—Å–∞–º–µ–Ω/–∞?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="loneliness" value="3"> –°–µ–∫–æ—ò–¥–Ω–µ–≤–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="loneliness" value="2"> –ù–µ–∫–æ–ª–∫—É –ø–∞—Ç–∏ –Ω–µ–¥–µ–ª–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="loneliness" value="1"> –ü–æ–Ω–µ–∫–æ–≥–∞—à
                </label>
                <label class="option">
                    <input type="radio" name="loneliness" value="0"> –†–µ—Ç–∫–æ –∏–ª–∏ –Ω–∏–∫–æ–≥–∞—à
                </label>
            </div>
        </div>

        <div class="question">
            <h3>–ö–æ–ª–∫—É –ª–µ—Å–Ω–æ —Ä–∞–∑–≥–æ–≤–∞—Ä–∞—à —Å–æ —Å–≤–æ–∏—Ç–µ –ø—Ä–∏—ò–∞—Ç–µ–ª–∏ –∑–∞ –ø—Ä–æ–±–ª–µ–º–∏—Ç–µ?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="friends_support" value="0"> –ú–Ω–æ–≥—É –ª–µ—Å–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="friends_support" value="1"> –õ–µ—Å–Ω–æ
                </label>
                <label class="option">
                    <input type="radio" name="friends_support" value="2"> –¢–µ—à–∫–æ
                </label>
                <label class="option">
                    <input type="radio" name="friends_support" value="3"> –ú–Ω–æ–≥—É —Ç–µ—à–∫–æ –∏–ª–∏ –Ω–µ–º–∞–º –ø—Ä–∏—ò–∞—Ç–µ–ª–∏
                </label>
            </div>
        </div>

        <div class="question">
            <h3>–ö–∞–∫–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –≤–æ —É—á–∏–ª–∏—à—Ç–µ?</h3>
            <div class="options">
                <label class="option">
                    <input type="radio" name="school" value="0"> –ú–Ω–æ–≥—É –¥–æ–±—Ä–æ, —Å–∞–∫–∞–º –¥–∞ –æ–¥–∞–º
                </label>
                <label class="option">
                    <input type="radio" name="school" value="1"> –î–æ–±—Ä–æ, –≥–µ–Ω–µ—Ä–∞–ª–Ω–æ –º–∏ —Å–µ –¥–æ–ø–∞—ì–∞
                </label>
                <label class="option">
                    <input type="radio" name="school" value="2"> –õ–æ—à–æ, —á–µ—Å—Ç–æ –Ω–µ —Å–∞–∫–∞–º –¥–∞ –æ–¥–∞–º
                </label>
                <label class="option">
                    <input type="radio" name="school" value="3"> –ú–Ω–æ–≥—É –ª–æ—à–æ, –Ω–µ —Å–∞–∫–∞–º –≤–æ–æ–ø—à—Ç–æ
                </label>
            </div>
        </div>

        <div class="navigation">
            <button class="btn btn-secondary" onclick="prevStep()">‚Üê –ù–∞–∑–∞–¥</button>
            <button class="btn btn-primary" onclick="calculateResults()">–í–∏–¥–∏ –†–µ–∑—É–ª—Ç–∞—Ç–∏ üìä</button>
        </div>
    </div>

    <!-- Results Step -->
    <div class="step" id="step-results">
        <h1>üìä –¢–≤–æ–∏—Ç–µ –†–µ–∑—É–ª—Ç–∞—Ç–∏</h1>
        <div class="results" id="results-content">
            <!-- Results will be populated here -->
        </div>
        <div class="navigation">
            <button class="btn btn-secondary" onclick="restart()">–ü–æ—á–Ω–∏ –û–¥–Ω–æ–≤–æ</button>
            <button class="btn btn-primary" onclick="downloadResults()">–ó–∞—á—É–≤–∞—ò –†–µ–∑—É–ª—Ç–∞—Ç–∏ üì•</button>
        </div>
    </div>
</div>

<script>
    window.jspdf.jsPDF.API.events.push(['addFonts', function () {
        this.addFileToVFS("Roboto-Regular-normal.ttf", robotoNormal);
        this.addFont("Roboto-Regular-normal.ttf", "Roboto", "normal");
    }]);

    let currentStep = 0;
    const steps = ['intro', 'physical', 'mental', 'social', 'results'];

    function updateProgress() {
        const progress = (currentStep / (steps.length - 1)) * 100;
        document.getElementById('progressFill').style.width = progress + '%';
    }

    function showStep(stepIndex) {
        // Hide all steps
        document.querySelectorAll('.step').forEach(step => {
            step.classList.remove('active');
        });

        // Show current step
        document.getElementById('step-' + steps[stepIndex]).classList.add('active');
        updateProgress();
    }

    function nextStep() {
        if (currentStep < steps.length - 1) {
            currentStep++;
            showStep(currentStep);
        }
    }

    function prevStep() {
        if (currentStep > 0) {
            currentStep--;
            showStep(currentStep);
        }
    }

    function restart() {
        currentStep = 0;
        showStep(currentStep);
        // Clear all selections
        document.querySelectorAll('input[type="radio"]').forEach(input => {
            input.checked = false;
        });
    }

    // Handle option selection styling
    document.addEventListener('change', function(e) {
        if (e.target.type === 'radio') {
            // Remove selected class from all options in the same group
            document.querySelectorAll(`input[name="${e.target.name}"]`).forEach(input => {
                input.closest('.option').classList.remove('selected');
            });
            // Add selected class to current option
            e.target.closest('.option').classList.add('selected');
        }
    });

    function calculateResults() {
        const physicalScore = getScore(['sleep', 'fatigue', 'activity']);
        const mentalScore = getScore(['stress', 'sadness', 'coping']);
        const socialScore = getScore(['loneliness', 'friends_support', 'school']);

        displayResults(physicalScore, mentalScore, socialScore);
        nextStep();
    }

    function getScore(questions) {
        let total = 0;
        questions.forEach(question => {
            const selected = document.querySelector(`input[name="${question}"]:checked`);
            if (selected) {
                total += parseInt(selected.value);
            }
        });
        return total;
    }

    function getScoreLevel(score, maxScore) {
        const percentage = (score / maxScore) * 100;
        if (percentage <= 30) return 'good';
        if (percentage <= 60) return 'warning';
        return 'concern';
    }

    function displayResults(physical, mental, social) {
        const resultsContent = document.getElementById('results-content');

        const physicalLevel = getScoreLevel(physical, 9);
        const mentalLevel = getScoreLevel(mental, 9);
        const socialLevel = getScoreLevel(social, 9);

        resultsContent.innerHTML = `
                ${generateCategoryResult('üèÉ‚Äç‚ôÇÔ∏è –§–∏–∑–∏—á–∫–æ –ó–¥—Ä–∞–≤—ò–µ', physical, 9, physicalLevel, getPhysicalFeedback(physicalLevel))}
                ${generateCategoryResult('üß† –ú–µ–Ω—Çalno –ó–¥—Ä–∞–≤—ò–µ', mental, 9, mentalLevel, getMentalFeedback(mentalLevel))}
                ${generateCategoryResult('üë• –°–æ—Ü–∏—ò–∞–ª–Ω–∏ –í—Ä—Å–∫–∏', social, 9, socialLevel, getSocialFeedback(socialLevel))}
                <div style="margin-top: 30px; padding: 20px; background: #f0fff4; border-radius: 15px; border: 2px solid #48bb78;">
                    <h3 style="color: #22543d; margin-bottom: 15px;">üí™ –¢–∏ —Å–∏ –ø–æ–≤–∞–∂–µ–Ω/–∞ –æ–¥ —à—Ç–æ –º–∏—Å–ª–∏—à!</h3>
                    <p style="color: #2d3748; line-height: 1.6;">
                        –°–µ–∫–æ—ò –∏–º–∞ –æ–±–ª–∞—Å—Ç–∏ –∫–∞–¥–µ –º–æ–∂–µ –¥–∞ —Å–µ –ø–æ–¥–æ–±—Ä–∏ - —Ç–æ–∞ –µ —Å–æ—Å–µ–º–∞ –Ω–æ—Ä–º–∞–ª–Ω–æ! –í–∞–∂–Ω–æ—Ç–æ –µ —à—Ç–æ —ò–∞ –Ω–∞–ø—Ä–∞–≤–∏ –ø—Ä–≤–∞—Ç–∞ —á–µ–∫–æ—Ä —Å–æ –æ–≤–∞–∞ —Å–∞–º–æ–µ–≤–∞–ª—É–∞—Ü–∏—ò–∞.
                        –°–µ–≥–∞ –∑–Ω–∞–µ—à –Ω–∞ —à—Ç–æ –¥–∞ –æ–±—Ä–Ω–µ—à –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –∫–∞–∫–æ –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—à –ø–æ–∑–∏—Ç–∏–≤–Ω–∏ –ø—Ä–æ–º–µ–Ω–∏.
                        <strong>–°–µ–∫–æ—ò–∞ –º–∞–ª–∞ –ø—Ä–æ–º–µ–Ω–∞ –∏–º–∞ –≥–æ–ª–µ–º–æ –∑–Ω–∞—á–µ—ö–µ!</strong> üåü
                    </p>
                </div>
            `;
    }

    function generateCategoryResult(title, score, maxScore, level, feedback) {
        const percentage = Math.round((1 - score / maxScore) * 100);
        const levelClass = level === 'good' ? '' : level;
        const scoreClass = level === 'good' ? '' : level;

        return `
                <div class="category-result ${levelClass}">
                    <h3>${title}</h3>
                    <div class="score ${scoreClass}">${percentage}%</div>
                    <div class="feedback">${feedback.text}</div>
                    <div class="tips">
                        <h4>üí° –¢–≤–æ–∏ –ª–∏—á–Ω–∏ —Å–æ–≤–µ—Ç–∏:</h4>
                        <ul>
                            ${feedback.tips.map(tip => `<li>${tip}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
    }

    function getPhysicalFeedback(level) {
        switch(level) {
            case 'good':
                return {
                    text: "–û–¥–ª–∏—á–Ω–æ! –¢–≤–æ–∏—Ç–µ —Ñ–∏–∑–∏—á–∫–∏ –Ω–∞–≤–∏–∫–∏ —Å–µ –Ω–∞ –¥–æ–±—Ä–æ –Ω–∏–≤–æ. –ü—Ä–æ–¥–æ–ª–∂–∏ –≤–∞–∫–∞! üåü",
                    tips: [
                        "–ü—Ä–æ–¥–æ–ª–∂–∏ —Å–æ —Ä–µ–¥–æ–≤–Ω–∞—Ç–∞ —Ñ–∏–∑–∏—á–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç",
                        "–û–¥—Ä–∂—É–≤–∞—ò –∑–¥—Ä–∞–≤–∏ –Ω–∞–≤–∏–∫–∏ –∑–∞ —Å–ø–∏–µ—ö–µ",
                        "–ü—Ä–æ—Å–ª–∞–≤–∏ –≥–∏ —Å–≤–æ–∏—Ç–µ —É—Å–ø–µ—Å–∏ - –∑–∞—Å–ª—É–∂—É–≤–∞—à –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ!",
                        "–ë–∏–¥–∏ –ø—Ä–∏–º–µ—Ä –∑–∞ —Ç–≤–æ–∏—Ç–µ –ø—Ä–∏—ò–∞—Ç–µ–ª–∏"
                    ]
                };
            case 'warning':
                return {
                    text: "–î–æ–±—Ä–æ —Å–∏, –Ω–æ –∏–º–∞ –ø—Ä–æ—Å—Ç–æ—Ä –∑–∞ –ø–æ–¥–æ–±—Ä—É–≤–∞—ö–µ. –°–æ –º–∞–ª–∏ –ø—Ä–æ–º–µ–Ω–∏ –º–æ–∂–µ—à –¥–∞ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –º–Ω–æ–≥—É –ø–æ–¥–æ–±—Ä–æ! üí™",
                    tips: [
                        "–û–±–∏–¥–∏ —Å–µ –¥–∞ —Å–ø–∏–µ—à 8-9 —á–∞—Å–∞ —Å–µ–∫–æ—ò–∞ –Ω–æ—ú",
                        "–ù–∞—ò–¥–∏ —Ñ–∏–∑–∏—á–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç –∫–æ—ò–∞ —Ç–∏ —Å–µ –¥–æ–ø–∞—ì–∞ (—Ç–∞–Ω—Ü—É–≤–∞—ö–µ, —à–µ—Ç–∞—ö–µ, —Å–ø–æ—Ä—Ç)",
                        "–ü—Ä–∞–≤–∏ –∫—Ä–∞—Ç–∫–∏ –ø–∞—É–∑–∏ –≤–æ —Ç–µ–∫–æ—Ç –Ω–∞ –¥–µ–Ω–æ—Ç",
                        "–ü–∏—ò –ø–æ–≤–µ—ú–µ –≤–æ–¥–∞ –∏ —ò–∞–¥–∏ –∑–¥—Ä–∞–≤–∞ —Ö—Ä–∞–Ω–∞"
                    ]
                };
            case 'concern':
                return {
                    text: "–¢–≤–æ–µ—Ç–æ —Ç–µ–ª–æ —Ç–∏ –ø—Ä–∞—ú–∞ —Å–∏–≥–Ω–∞–ª–∏ –¥–µ–∫–∞ —Ç—Ä–µ–±–∞ –¥–∞ —Å–µ –≥—Ä–∏–∂–∏—à –ø–æ–¥–æ–±—Ä–æ –∑–∞ —Å–µ–±–µ. –ù–µ —Å–µ –≥—Ä–∏–∂–∏, —Å–æ –º–∞–ª–∏ —á–µ–∫–æ—Ä–∏ –º–æ–∂–µ—à –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏—à –≥–æ–ª–µ–º–∏ –ø—Ä–æ–º–µ–Ω–∏! ",
                    tips: [
                        "–ó–∞–ø–æ—á–Ω–∏ —Å–æ 15-–º–∏–Ω—É—Ç–Ω–∞ —à–µ—Ç–∫–∞ —Å–µ–∫–æ—ò–¥–µ–Ω",
                        "–ü–æ—Å—Ç–∞–≤–∏ —Ä—É—Ç–∏–Ω–∞ –∑–∞ —Å–ø–∏–µ—ö–µ - –ª–µ–≥–Ω–∏ –∏ —Å—Ç–∞–Ω–∏ –≤–æ –∏—Å—Ç–æ –≤—Ä–µ–º–µ",
                        "–†–∞–∑–≥–æ–≤–∞—Ä–∞—ò —Å–æ —Ä–æ–¥–∏—Ç–µ–ª–∏ –∏–ª–∏ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –∑–∞ —Ç–æ–∞ –∫–∞–∫–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à",
                        "–ù–∞—ò–¥–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç –∫–æ—ò–∞ —Ç–∏ –Ω–æ—Å–∏ —Ä–∞–¥–æ—Å—Ç"
                    ]
                };
        }
    }

    function getMentalFeedback(level) {
        switch(level) {
            case 'good':
                return {
                    text: "–ú–µ–Ω—Ç–∞–ª–Ω–æ —Å–∏ –≤–æ –æ–¥–ª–∏—á–Ω–∞ —Ñ–æ—Ä–º–∞! –£–º–µ–µ—à –¥–∞ —Å–µ —Å–ø—Ä–∞–≤—É–≤–∞—à —Å–æ –ø—Ä–µ–¥–∏–∑–≤–∏—Ü–∏—Ç–µ. –ë—Ä–∞–≤–æ! ",
                    tips: [
                        "–ü—Ä–æ–¥–æ–ª–∂–∏ –¥–∞ –ø—Ä–∞–∫—Ç–∏–∫—É–≤–∞—à —Ç–µ—Ö–Ω–∏–∫–∏ –∑–∞ —Ä–µ–ª–∞–∫—Å–∞—Ü–∏—ò–∞",
                        "–ë–∏–¥–∏ –±–ª–∞–≥–æ–¥–∞—Ä–µ–Ω –∑–∞ –º–∞–ª–∏—Ç–µ —Ä–∞–±–æ—Ç–∏ –≤–æ –∂–∏–≤–æ—Ç–æ—Ç",
                        "–ü–æ–º–∞–≥–∞—ò –Ω–∞ –¥—Ä—É–≥–∏—Ç–µ - —Ç–æ–∞ —Ç–µ –ø—Ä–∞–≤–∏ –ø–æ—Å—Ä–µ—ú–µ–Ω/–∞",
                        "–í–æ–¥–∏ –¥–Ω–µ–≤–Ω–∏–∫ –∑–∞ —Ç–≤–æ–∏—Ç–µ –ø–æ–∑–∏—Ç–∏–≤–Ω–∏ –∏—Å–∫—É—Å—Ç–≤–∞"
                    ]
                };
            case 'warning':
                return {
                    text: "–ü–æ–Ω–µ–∫–æ–≥–∞—à —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –ø–æ–¥ –ø—Ä–∏—Ç–∏—Å–æ–∫, –∞ —Ç–æ–∞ –µ –Ω–æ—Ä–º–∞–ª–Ω–æ. –í–∞–∂–Ω–æ –µ –¥–∞ –∑–Ω–∞–µ—à –∫–∞–∫–æ –¥–∞ —Å–µ —Å–ø—Ä–∞–≤—É–≤–∞—à —Å–æ —Ç–æ–∞! ",
                    tips: [
                        "–í–µ–∂–±–∞—ò –¥–ª–∞–±–æ–∫–æ –¥–∏—à–µ—ö–µ –∫–æ–≥–∞ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –Ω–µ—Ä–≤–æ–∑–Ω–æ",
                        "–†–∞–∑–≥–æ–≤–∞—Ä–∞—ò —Å–æ –ª—É—ì–µ—Ç–æ –∫–æ–∏ —Ç–∏ –≤–µ—Ä—É–≤–∞–∞—Ç",
                        "–ü—Ä–∞–≤–∏ —Ä–∞–±–æ—Ç–∏ –∫–æ–∏ —Ç–∏ –Ω–æ—Å–∞—Ç —Ä–∞–¥–æ—Å—Ç —Å–µ–∫–æ—ò –¥–µ–Ω",
                        "–ù–µ —Å–µ —Å—Ç—Ä–µ–º–∏—à –¥–∞ –±–∏–¥–µ—à —Å–æ–≤—Ä—à–µ–Ω/–∞ - –¥–æ–≤–æ–ª–Ω–æ —Å–∏ –¥–æ–±–∞—Ä/–∞ –∫–∞–∫–æ —à—Ç–æ —Å–∏"
                    ]
                };
            case 'concern':
                return {
                    text: "–ó–Ω–∞–µ—à –¥–µ–∫–∞ –Ω–µ —Å–∏ —Å–∞–º/–∞ –≤–æ –æ–≤–∞? –ú–Ω–æ–≥—É –º–ª–∞–¥–∏ –ª—É—ì–µ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞–∞—Ç –∫–∞–∫–æ —Ç–µ–±–µ. –ò–º–∞ –Ω–∞—á–∏–Ω–∏ –¥–∞ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –ø–æ–¥–æ–±—Ä–æ, –∞ –ø—Ä–≤–∏–æ—Ç —á–µ–∫–æ—Ä –µ —à—Ç–æ –±–∞—Ä–∞—à –ø–æ–º–æ—à! üíô",
                    tips: [
                        "–†–∞–∑–≥–æ–≤–∞—Ä–∞—ò —Å–æ —Ä–æ–¥–∏—Ç–µ–ª, –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –∏–ª–∏ –ø—Å–∏—Ö–æ–ª–æ–≥",
                        "–à–∞–≤–∏ —Å–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω –∑–∞ –ø–æ–º–æ—à –∞–∫–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –º–Ω–æ–≥—É –ª–æ—à–æ",
                        "–ü–∏—à–∏ —Å–∏ –¥–Ω–µ–≤–Ω–∏–∫ –∑–∞ —á—É–≤—Å—Ç–≤–∞—Ç–∞",
                        "–ù–∞—ò–¥–∏ –µ–¥–Ω–æ –Ω–µ—à—Ç–æ —à—Ç–æ —Ç–µ –ø—Ä–∞–≤–∏ —Å—Ä–µ—ú–µ–Ω/–∞ —Å–µ–∫–æ—ò –¥–µ–Ω, –º–∞–∫–∞—Ä –∏ –º–∞–ª–æ"
                    ]
                };
        }
    }

    function getSocialFeedback(level) {
        switch(level) {
            case 'good':
                return {
                    text: "–ò–º–∞—à –æ–¥–ª–∏—á–Ω–∏ —Å–æ—Ü–∏—ò–∞–ª–Ω–∏ –≤—Ä—Å–∫–∏! –£–º–µ–µ—à –¥–∞ —Å–µ –ø–æ–≤—Ä–∑—É–≤–∞—à —Å–æ –¥—Ä—É–≥–∏—Ç–µ –∏ –¥–∞ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –¥–µ–ª –æ–¥ –∑–∞–µ–¥–Ω–∏—Ü–∞—Ç–∞. –¢–æ–∞ –µ –≤—Ä–µ–¥–Ω–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç! ü§ù",
                    tips: [
                        "–ü—Ä–æ–¥–æ–ª–∂–∏ –¥–∞ –≥—Ä–∞–¥–∏—à –¥–ª–∞–±–æ–∫–∏ –ø—Ä–∏—ò–∞—Ç–µ–ª—Å—Ç–≤–∞",
                        "–ë–∏–¥–∏ –¥–æ–±–∞—Ä —Å–ª—É—à–∞—Ç–µ–ª –∑–∞ —Ç–≤–æ–∏—Ç–µ –ø—Ä–∏—ò–∞—Ç–µ–ª–∏",
                        "–£—á–µ—Å—Ç–≤—É–≤–∞—ò –≤–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ–∏ —Ç–∏ —Å–µ –¥–æ–ø–∞—ì–∞–∞—Ç",
                        "–ë–∏–¥–∏ –º–µ–Ω—Ç–æ—Ä –∑–∞ –ø–æ–º–ª–∞–¥–∏—Ç–µ —É—á–µ–Ω–∏—Ü–∏"
                    ]
                };
            case 'warning':
                return {
                    text: "–ü–æ–Ω–µ–∫–æ–≥–∞—à —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à –∏–∑–æ–ª–∏—Ä–∞–Ω/–∞, –Ω–æ –∏–º–∞—à –ø–æ—Ç–µ–Ω—Ü–∏—ò–∞–ª –¥–∞ –≥—Ä–∞–¥–∏—à —É–±–∞–≤–∏ –≤—Ä—Å–∫–∏! –ü–æ—Ç—Ä–µ–±–Ω–æ –µ –º–∞–ª–∫—É –ø–æ–≤–µ—ú–µ —Å–∞–º–æ–¥–æ–≤–µ—Ä–±–∞. üåü",
                    tips: [
                        "–ó–∞–ø–æ—á–Ω–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä —Å–æ –µ–¥–Ω–æ –ª–∏—Ü–µ –∫–æ–µ —Ç–∏ —Å–µ –¥–æ–ø–∞—ì–∞",
                        "–ü—Ä–∏–¥—Ä—É–∂–∏ —Å–µ –Ω–∞ –∫–ª—É–± –∏–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç –≤–æ —É—á–∏–ª–∏—à—Ç–µ",
                        "–ë–∏–¥–∏ –∏—Å–∫—Ä–µ–Ω/–∞ —Å–æ –±–ª–∏–∑–∫–∏—Ç–µ –ª—É—ì–µ –∑–∞ —Ç–æ–∞ –∫–∞–∫–æ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞—à",
                        "–ü–æ–º–Ω–∏: –∫–≤–∞–ª–∏—Ç–µ—Ç–æ—Ç –Ω–∞ –ø—Ä–∏—ò–∞—Ç–µ–ª—Å—Ç–≤–∞—Ç–∞ –µ –ø–æ–≤–∞–∂–µ–Ω –æ–¥ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ—Ç–æ"
                    ]
                };
            case 'concern':
                return {
                    text: "–ß—É–≤—Å—Ç–≤—É–≤–∞—à —Å–µ –∏–∑–æ–ª–∏—Ä–∞–Ω/–∞ –∏ —Ç–æ–∞ –µ –±–æ–ª–Ω–æ. –ù–æ –∑–Ω–∞—ò –¥–µ–∫–∞ –æ–≤–∞ –Ω–µ –µ —Ç—Ä–∞–µ–Ω - —Å–µ–∫–æ—ò –∑–∞—Å–ª—É–∂—É–≤–∞ –¥–∞ –∏–º–∞ –ª—É—ì–µ –∫–æ–∏ –≥–∏ —Å–∞–∫–∞–∞—Ç. –¢–∏ –∏—Å—Ç–æ! üíö",
                    tips: [
                        "–†–∞–∑–≥–æ–≤–∞—Ä–∞–π —Å–æ —à–∫–æ–ª—Å–∫–∏–æ—Ç –ø—Å–∏—Ö–æ–ª–æ–≥ –∑–∞ —Ç–≤–æ–∏—Ç–µ —á—É–≤—Å—Ç–≤–∞",
                        "–ó–∞–ø–æ—á–Ω–∏ —Å–æ –º–∞–ª–∏ —á–µ–∫–æ—Ä–∏ - –Ω–∞—Å–º–µ–≤–Ω–∏ —Å–µ –Ω–∞ –µ–¥–µ–Ω —á–æ–≤–µ–∫ —Å–µ–∫–æ—ò –¥–µ–Ω",
                        "–ù–∞—ò–¥–∏ –≥—Ä—É–ø–∏ —Å–æ —Å–ª–∏—á–Ω–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∏ (—Å–ø–æ—Ä—Ç, —É–º–µ—Ç–Ω–æ—Å—Ç, –º—É–∑–∏–∫–∞)",
                        "–ü–æ–º–Ω–∏ –¥–µ–∫–∞ –º–Ω–æ–≥—É –ª—É—ì–µ —Å–µ —á—É–≤—Å—Ç–≤—É–≤–∞–∞—Ç —Å–ª–∏—á–Ω–æ - –Ω–µ —Å–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω/–∞",
                        "–ë–∞—Ä–∞ –ø–æ–º–æ—à –æ–¥ –≤–æ–∑—Ä–∞—Å–Ω–∏ –∫–æ–∏ —Ç–∏ –≤–µ—Ä—É–≤–∞–∞—Ç"
                    ]
                };
        }
    }

    async function downloadResults() {
        const { Document, Packer, Paragraph, TextRun } = window.docx;

        const physicalScore = getScore(['sleep', 'fatigue', 'activity']);
        const mentalScore = getScore(['stress', 'sadness', 'coping']);
        const socialScore = getScore(['loneliness', 'friends_support', 'school']);

        const physicalLevel = getScoreLevel(physicalScore, 9);
        const mentalLevel = getScoreLevel(mentalScore, 9);
        const socialLevel = getScoreLevel(socialScore, 9);

        const physicalFeedback = getPhysicalFeedback(physicalLevel);
        const mentalFeedback = getMentalFeedback(mentalLevel);
        const socialFeedback = getSocialFeedback(socialLevel);

        const today = new Date().toLocaleDateString('mk-MK');

        const doc = new Document({
            sections: [{
                properties: {},
                children: [
                    new Paragraph({
                        children: [
                            new TextRun({ text: "–ú–æ—ò–∞ –î–æ–±—Ä–æ—Å–æ—Å—Ç–æ—ò–±–∞ - –†–µ–∑—É–ª—Ç–∞—Ç–∏", bold: true, size: 32 }),
                        ],
                    }),
                    new Paragraph({ text: `–î–∞—Ç—É–º: ${today}`, spacing: { after: 200 } }),

                    // Physical Health
                    new Paragraph({ text: `–§–∏–∑–∏—á–∫–æ –ó–¥—Ä–∞–≤—ò–µ: ${Math.round((1 - physicalScore / 9) * 100)}%`, bold: true }),
                    new Paragraph({ text: physicalFeedback.text }),
                    new Paragraph({ text: "–°–æ–≤–µ—Ç–∏:", bold: true }),
                    ...physicalFeedback.tips.map(tip => new Paragraph("‚Ä¢ " + tip)),

                    new Paragraph({ text: "" }),

                    // Mental Health
                    new Paragraph({ text: `–ú–µ–Ω—Ç–∞–ª–Ω–æ –ó–¥—Ä–∞–≤—ò–µ: ${Math.round((1 - mentalScore / 9) * 100)}%`, bold: true }),
                    new Paragraph({ text: mentalFeedback.text }),
                    new Paragraph({ text: "–°–æ–≤–µ—Ç–∏:", bold: true }),
                    ...mentalFeedback.tips.map(tip => new Paragraph("‚Ä¢ " + tip)),

                    new Paragraph({ text: "" }),

                    // Social Connections
                    new Paragraph({ text: `–°–æ—Ü–∏—ò–∞–ª–Ω–∏ –í—Ä—Å–∫–∏: ${Math.round((1 - socialScore / 9) * 100)}%`, bold: true }),
                    new Paragraph({ text: socialFeedback.text }),
                    new Paragraph({ text: "–°–æ–≤–µ—Ç–∏:", bold: true }),
                    ...socialFeedback.tips.map(tip => new Paragraph("‚Ä¢ " + tip)),

                    new Paragraph({ text: "" }),
                    new Paragraph({
                        children: [
                            new TextRun({
                                text: "–û–≤–æ—ò –¥–æ–∫—É–º–µ–Ω—Ç –µ –∫—Ä–µ–∏—Ä–∞–Ω –∑–∞ –ª–∏—á–Ω–∞ —É–ø–æ—Ç—Ä–µ–±–∞. –ó–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª–Ω–∞ –ø–æ–º–æ—à –∫–æ–Ω—Ç–∞–∫—Ç–∏—Ä–∞—ò —Å–æ —Ä–æ–¥–∏—Ç–µ–ª–∏, –Ω–∞—Å—Ç–∞–≤–Ω–∏—Ü–∏ –∏–ª–∏ –ø—Å–∏—Ö–æ–ª–æ–≥.",
                                size: 18,
                                italics: true
                            })
                        ]
                    })
                ]
            }]
        });

        const blob = await Packer.toBlob(doc);
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `moja-dobrosostojba-${new Date().toISOString().split('T')[0]}.docx`;
        a.click();
    }


    // Initialize progress bar
    updateProgress();

    // Add some interactive hover effects
    document.addEventListener('DOMContentLoaded', function() {
        // Add hover effect to options
        const options = document.querySelectorAll('.option');
        options.forEach(option => {
            option.addEventListener('mouseenter', function() {
                if (!this.querySelector('input').checked) {
                    this.style.transform = 'translateX(5px)';
                }
            });

            option.addEventListener('mouseleave', function() {
                if (!this.querySelector('input').checked) {
                    this.style.transform = 'translateX(0)';
                }
            });
        });
    });

    // Handle form validation before proceeding
    function canProceed() {
        const currentStepElement = document.getElementById('step-' + steps[currentStep]);
        const requiredInputs = currentStepElement.querySelectorAll('input[type="radio"]');
        const groups = {};

        // Group inputs by name
        requiredInputs.forEach(input => {
            if (!groups[input.name]) {
                groups[input.name] = [];
            }
            groups[input.name].push(input);
        });

        // Check if each group has a selection
        for (let groupName in groups) {
            const groupInputs = groups[groupName];
            const hasSelection = groupInputs.some(input => input.checked);
            if (!hasSelection) {
                return false;
            }
        }

        return true;
    }

    // Override nextStep function to include validation
    const originalNextStep = nextStep;
    nextStep = function() {
        if (currentStep > 0 && currentStep < 4) { // Skip validation for intro and results
            if (!canProceed()) {
                alert('–í–µ –º–æ–ª–∏–º–µ –æ–¥–≥–æ–≤–æ—Ä–µ—Ç–µ –Ω–∞ —Å–∏—Ç–µ –ø—Ä–∞—à–∞—ö–∞ –ø—Ä–µ–¥ –¥–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ.');
                return;
            }
        }
        originalNextStep();
    };

    // Override calculateResults to include validation
    const originalCalculateResults = calculateResults;
    calculateResults = function() {
        if (!canProceed()) {
            alert('–í–µ –º–æ–ª–∏–º–µ –æ–¥–≥–æ–≤–æ—Ä–µ—Ç–µ –Ω–∞ —Å–∏—Ç–µ –ø—Ä–∞—à–∞—ö–∞ –ø—Ä–µ–¥ –¥–∞ –≥–∏ –≤–∏–¥–∏—Ç–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏—Ç–µ.');
            return;
        }
        originalCalculateResults();
    };
</script>
</body>
</html>